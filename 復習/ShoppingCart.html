<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <title>Shopping Cart</title>

        <link rel="preconnect" href="https://fonts.gstatic.com" />
        <link
            href="https://fonts.googleapis.com/css2?family=Bungee+Inline&family=Nunito+Sans:wght@400;600;700;800;900&display=swap"
            rel="stylesheet" />
        <link
            rel="stylesheet"
            href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
            integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN"
            crossorigin="anonymous" />
        <style>
            *,
            *::before,
            *::after {
                margin: 0;
                padding: 0;
                box-sizing: inherit;
            }

            html {
                font-size: 62.5%;
                box-sizing: border-box;
            }

            body {
                padding: 2rem 4rem;
                line-height: 1.7;
                font-family: 'Nunito Sans', sans-serif;
                color: #555;
                min-height: 100vh;
                background-image: linear-gradient(to bottom right, #67b26f, #4ca2cd);
            }

            img {
                max-width: 100%;
                vertical-align: middle;
                border-radius: 4px;
            }

            a {
                text-decoration: none;
                color: #333333;
            }

            a:hover {
                color: #f58551;
            }

            button {
                background-color: #16cc9b;
                border: 2px solid #16cc9b;
                color: #ffffff;
                transition: all 0.25s linear;
                cursor: pointer;
            }

            button::after {
                position: relative;
                right: 0;
                content: ' \276f';
                transition: all 0.15s linear;
            }

            button:hover {
                background-color: #f58551;
                border-color: #f58551;
            }

            button:hover::after {
                right: -5px;
            }

            button:focus {
                outline: none;
            }

            ul {
                padding: 0;
                margin: 0;
                list-style-type: none;
            }

            input {
                transition: all 0.25s linear;
            }

            input[type='number']::-webkit-inner-spin-button,
            input[type='number']::-webkit-outer-spin-button {
                -webkit-appearance: none;
                -moz-appearance: none;
                appearance: none;
                margin: 0;
            }

            input {
                outline: none;
            }

            .container {
                width: 90%;
                margin: 0 auto;
                overflow: auto;
            }

            /* --- HEADER --- */
            header h1 {
                font-family: 'Bungee Inline', sans-serif;
                font-weight: 400;
                font-size: 3rem;
                color: white;
                margin-bottom: 2rem;
                text-align: center;
                word-spacing: 3px;
            }

            header.container {
                margin-bottom: 1.5rem;
            }

            header .breadcrumb li {
                float: left;
                padding: 0 6px;
            }

            header .breadcrumb li:first-child {
                padding-left: 2px;
            }

            header .breadcrumb li:not(:last-child)::after {
                content: ' \276f';
                padding-left: 8px;
            }

            header .count {
                float: right;
            }

            /* --- PRODUCT LIST --- */
            .products {
                border-top: 1px solid #ddd;
            }

            .products > li {
                padding: 1rem 0;
                background-color: #fff;
                padding: 1rem;
                margin-bottom: 1rem;
            }

            .row {
                display: flex;
            }

            .col.left {
                flex-basis: 70%;
            }

            .col.right {
                flex-basis: 30%;
                display: flex;
                align-items: center;
            }

            .detail {
                padding: 0 0.5rem;
                line-height: 2.2rem;
            }

            .detail .name {
                font-size: 1.2rem;
                font-weight: 700;
            }

            .detail .description {
                font-size: 1rem;
                margin: 0.7rem 0;
                line-height: 1.4;
            }

            .detail .price {
                font-size: 1.2rem;
                font-weight: 700;
            }

            .quantity,
            .remove {
                width: 50%;
                text-align: center;
            }

            .quantity > input {
                display: inline-block;
                width: 60px;
                height: 60px;
                position: relative;
                left: calc(50% - 30px);
                background: #fff;
                border: 2px solid #ddd;
                text-align: center;
                font: 600 1.5rem Helvetica, Arial, sans-serif;
            }

            .quantity > input:hover,
            .quantity > input:focus {
                border-color: #f58551;
            }

            .close {
                cursor: pointer;
                font-size: 1.5rem;
            }

            .close:hover {
                color: #f58551;
            }

            /* --- SUMMARY --- */
            .promotion,
            .summary,
            .checkout {
                float: left;
                width: 100%;
                margin-top: 1.5rem;
            }

            .promotion > label {
                float: left;
                width: 100%;
                margin-bottom: 1rem;
            }

            .promotion > input {
                float: left;
                width: 80%;
                font-size: 1rem;
                padding: 1rem 1.5rem;
                border: 2px solid #16cc9b;
            }

            .promotion:hover > input {
                border-color: #f58551;
            }

            .promotion > button {
                float: left;
                width: 20%;
                padding: 1rem 0.5rem;
            }

            .promotion:hover > button {
                border-color: #f58551;
                background-color: #f58551;
            }

            .promotion > button::after {
                content: '\276f';
                font-size: 1rem;
            }

            .summary {
                font-size: 1.2rem;
                text-align: right;
            }

            .summary ul li {
                padding: 0.5rem 0;
            }

            .summary ul li span {
                display: inline-block;
                width: 30%;
            }

            .summary ul li.total {
                font-weight: bold;
            }

            .hide {
                display: none !important;
            }

            .error-message {
                color: darkred;
                font-size: 25px;
            }

            /* --- SMALL SCREEN --- */
            @media all and (max-width: 599px) {
                .thumbnail img {
                    display: none;
                }

                .quantity > input {
                    width: 40px;
                    height: 40px;
                    left: calc(50% - 20px);
                }

                .remove svg {
                    width: 40px;
                    height: 40px;
                }
            }

            /* --- MEDIUM & LARGE SCREEN --- */
            @media all and (min-width: 600px) {
                html {
                    font-size: 14px;
                }

                .container {
                    width: 75%;
                    max-width: 960px;
                }

                .thumbnail,
                .detail {
                    float: left;
                }

                .thumbnail {
                    width: 30%;
                }

                .detail {
                    width: 65%;
                    padding: 0 1rem;
                }

                .promotion,
                .summary {
                    width: 50%;
                }

                .checkout {
                    width: 100%;
                }

                .checkout,
                .summary {
                    text-align: right;
                }
            }

            /* --- LARGE SCREEN --- */
            @media all and (min-width: 992px) {
                html {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body>
        <main>
            <header class="container">
                <h1>Shopping Cart</h1>

                <ul class="breadcrumb">
                    <li>Home</li>
                    <li>Shopping Cart</li>
                </ul>

                <!-- Total product -->
                <span class="count">3 items in the bag</span>
            </header>
            <section class="container">
                <ul class="products" id="products"></ul>
                <!-- Đã thêm thẻ đóng cho phần tử ul -->
            </section>
            <section class="option-container container">
                <!-- Mã giảm giá (promo code) -->
                <div class="promotion">
                    <label for="promo-code">Have A Promo Code?</label>
                    <input type="text" id="promo-code" autocomplete="off" />
                    <button type="button" onclick="applyPromoCode()"></button>
                </div>
                <!-- Tổng tiền -->
                <div class="summary">
                    <ul>
                        <li class="subtotal">Subtotal: <span id="subtotal_value"></span></li>
                        <li class="vat">VAT:<span id="vat_value"></span></li>
                        <li class="discount hide">Discount<span></span></li>
                        <li class="total">Total: <span id="total_value"></span></li>
                    </ul>
                </div>
            </section>
        </main>
        <script>
            var sanPham = [
                {
                    id: 1,
                    ten: 'laptop Asus',
                    moTa: 'máy tính Asus',
                    gia: 20,
                },
                {
                    id: 2,
                    ten: 'laptop Acer',
                    moTa: 'máy tính Acer',
                    gia: 19,
                },
                {
                    id: 3,
                    ten: 'laptop Dell',
                    moTa: 'máy tính Dell',
                    gia: 25,
                },
                {
                    id: 4,
                    ten: 'laptop Logitech',
                    moTa: 'máy tính Logitech',
                    gia: 22,
                },
            ];

            function hienThiGiaoDien() {
                let html = '';
                if (sanPham.length === 0) {
                    html = ' Chưa có sản phẩm nào trong giỏ hàng';
                } else {
                    for (let i = 0; i < sanPham.length; i++) {
                        html += `<li class="hang">
                    <div class="cot trai">
                        <div class="hinh-anh">
                            <a href="#"><img src="https://via.placeholder.com/200x150" alt="" /></a>
                        </div>
                        <div class="chi-tiet">
                            <div class="ten"><a href="#">${sanPham[i].ten}</a></div>
                            <div class="mo-ta">${sanPham[i].moTa}</div>
                            <div class="gia">$${sanPham[i].gia}</div>
                            <div class="thanh-tien" id="tien_${sanPham[i].id}"></div>
                        </div>
                    </div>
                    <div class="cot phai">
                        <div class="so-luong">
                            <input
                            type="number"
                            onkeyup="capNhatSoLuong(${sanPham[i].id}, ${sanPham[i].gia})"
                            class="so-luong-san-pham"
                            id="sanPham_${sanPham[i].id}" 
                            step="1" value="1" 
                            />
                        </div>
                        <div class="xoa">
                            <span class="dong"><i class="fa fa-times" aria-hidden="true"></i></span>
                        </div>
                    </div>
                </li>`;
                    }
                }
                document.getElementById('products').innerHTML = html;
            }
            hienThiGiaoDien(); // Gọi hàm để hiển thị các sản phẩm

            // Hàm tính tổng tiền các sản phẩm và cập nhật lại các giá trị trong phần tổng kết
            function capNhatTongTien() {
                const sanPhamContainer = document.getElementById('products');
                const danhSachSanPham = sanPhamContainer.children;
                let tongTien = 0;
                let thueVAT = 0;
                let giamGia = 0;
                let tongTienSauGiamGia = 0;
                for (let i = 0; i < danhSachSanPham.length; i++) {
                    const giaSanPham = parseFloat(
                        danhSachSanPham[i].querySelector('.gia').textContent.replace('$', ''),
                    );
                    const soLuongSanPham = parseFloat(danhSachSanPham[i].querySelector('.so-luong-san-pham').value);
                    tongTien += giaSanPham * soLuongSanPham;
                }
                // Tính thuế VAT và cộng vào tổng giá trị
                thueVAT = tongTien * 0.1;
                // Tính tổng tiền sau khi áp dụng giảm giá
                tongTienSauGiamGia = tongTien + thueVAT - giamGia;

                document.getElementById('subtotal_value').textContent = `$${tongTien.toFixed(2)}`;
                document.getElementById('vat_value').textContent = `$${thueVAT.toFixed(2)}`;
                document.getElementById('total_value').textContent = `$${tongTienSauGiamGia.toFixed(2)}`;
            }

            function capNhatSoLuong(id, gia) {
                let soLuong = document.getElementById('sanPham_' + id).value;
                if (soLuong <= 0) {
                    document.getElementById('tien_' + id).innerHTML = 'Vui lòng không nhập số lượng âm';
                } else {
                    let thanhTienMoi = soLuong * gia;
                    document.getElementById('tien_' + id).innerHTML = '$' + thanhTienMoi;
                }
                capNhatTongTien();
            }
            capNhatTongTien();

            function applyPromoCode() {
                // Hàm xử lý việc áp dụng mã giảm giá (thiết lập chưa được cung cấp trong mã nguồn gốc)
            }

            // Bộ lắng nghe sự kiện để xóa sản phẩm
            document.addEventListener('click', function (event) {
                if (event.target.classList.contains('fa-times')) {
                    const sanPhamElement = event.target.closest('.hang');
                    const sanPhamId = parseInt(
                        sanPhamElement.querySelector('.so-luong-san-pham').id.replace('sanPham_', ''),
                    );
                    sanPham = sanPham.filter((sanPham) => sanPham.id !== sanPhamId);
                    sanPhamElement.remove();
                    capNhatTongTien();
                }
            });
        </script>
    </body>
</html>
